---
title: "Rapport
‚Äî‚Äî‚Äî‚ÄîD√©couvrez la performance du chiffre d'affaires d‚Äôun supermarch√©"
author: "LinZhifan, DaiYifei, Wuyuan, ChenZhaoyang"
date: "2024-04-29"
output:
  html_document: default
  pdf_document: default
---



```{r setup, include=FALSE}
library(readr)
library(plotly)
library(tidyverse)
library(ggthemes)
library(gridExtra)
library(RColorBrewer)

library(dplyr)
library(ggplot2)
library(lubridate)
library(scales)
library(forecast)
library(tibble)
library(knitr)
library(kableExtra)

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```


# 1 Proposition
## 1.1 Introduction
Mon groupe envisage d'utiliser deux ensembles de donn√©es dans notre projet de cours. Le premier ensemble de donn√©es couvre les ventes d‚Äôune grande cha√Æne de supermarch√©s aux √âtats-Unis de 2014 √† 2017, et le deuxi√®me ensemble de donn√©es couvre les ventes de Walmart Myanmar au premier trimestre 2019. Notre analyse se concentrera sur cinq dimensions¬†: la commande, le client, le produit, la m√©t√©o et l'emplacement. Nous analyserons principalement les donn√©es pertinentes des supermarch√©s am√©ricains, chercherons √† comprendre les raisons possibles de la baisse du taux de croissance des ventes et proposerons des moyens d'augmenter les ventes. Dans le m√™me temps, nous comparerons √©galement les transactions entre les √âtats-Unis et le Myanmar afin de mieux comprendre le march√© et de fournir des donn√©es pour les strat√©gies de march√© transfrontali√®res.

## 1.2 Donn√©e

### 1.2.1 L'info de vente pour une cha√Æne de supermarch√© aux √âtats-Unis

Ensemble de donn√©es sur le commerce de d√©tail d'une grande surface internationale pendant 4 ans aux √âtats-Unis. Il comprend divers attributs, notamment le ID de la command, la date de commande, la date d‚Äôexp√©dition, le mode d‚Äôexp√©dition, ID de client, le nom du client, le pay de cette commande, la ville de commande, le code postal, la r√©gion, ID de produit, la cat√©gorie de produit, le nom du produit, le montant des ventes de ce produit, le nombre d‚Äôunit√© (pi√®ce) de ce produit, le montant de r√©duction de ce produit. Ce riche ensemble de donn√©es facilite l'analyse d√©taill√©e et la compr√©hension des pr√©f√©rences des clients, de la fa√ßon de transport, de la g√©n√©ration de revenus, ce qui permet aux entreprises de changer leurs strat√©gies pour enlever la satisfaction des clients.

- **Nombre d‚Äôobservations**: 9995
- **Nombre de variables**: 21

- **[Source üöÄ](https://www.kaggle.com/aksha17/superstore-sales)**

```{r echo=FALSE, results='asis'}
data_description <- data.frame(
  Caract√©ristique = c("invoice_id", "branch", "city", "customer_type", "gender", "product_line", "unit_price", "quantity", "vat", "total", "dtme", "tme", "payment_method", "cogs", "gross_margin_pct", "gross_income", "rating", "time_of_day", "day_name", "month_name"),
  Description = c(
    "Identifiant de la facture", 
    "Le symbol de ce cha√Æne de Walmart", 
    "La ville o√π se trouve le Walmart", 
    "Membre ou non (carte de fid√©lit√©)", 
    "Sexe de ce client", 
    "Cat√©gorie de cet article", 
    "Prix d‚Äôun pi√®ce", 
    "Quantit√© des articles achet√©s", 
    "TVA en France", 
    "Montant total d‚Äôachat", 
    "Date et l'heure de l'achat", 
    "Heure pr√©cise de l‚Äôachat", 
    "Mode de paiement, comme esp√®ces", 
    "Co√ªt d'un produit vendu", 
    "Marge brute en pourcentage(%)", 
    "Revenu brut total", 
    "√âvaluation de l'exp√©rience d'achat", 
    "Moment d‚Äôachat, comme matin/midi", 
    "Jour de la semaine", 
    "Mois o√π l'achat a √©t√© effectu√©"
  ),
  Type = c("String", "char(A, B, C)", "String", "String(Membre, Normal)", "String(Female, Male)", "String", "float", "int", "float", "float", "DATE(YYYY/MM/DD)", "TIME(HH:MM:SS)", "char", "float", "float", "float", "float", "String", "String", "String")
)

# Utilisez la fonction kable pour cr√©er un tableau et ajouter des lignes de s√©paration
kable(data_description, col.names = c("Caract√©ristique", "Description", "Type"), format = "html") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F) %>%
  add_header_above(c(" " = 3)) %>%
  column_spec(1, border_right = TRUE) %>%
  column_spec(2, border_right = TRUE) %>%
  row_spec(0, bold = TRUE, color = "white", background = "#4CAF50") %>%
  row_spec(1:nrow(data_description), hline_after = TRUE)
```


### 1.2.2 L'info de vente dans 3 cha√Ænes Walmart en Birmanie

L'ensemble de donn√©es fournit des informations compl√®tes sur les transactions de vente effectu√©es par Walmart, l'une des principales cha√Ænes de magasins au monde. Il comprend divers attributs, notamment l'ID de la facture, la succursale, la ville, le type de client, le sexe, la ligne de produit, le prix unitaire, la quantit√©, la taxe (5 %), le prix total, la date, l'heure, le mode de paiement, le co√ªt des marchandises vendues (COGS), le pourcentage de marge brute, le revenu brut et l'√©valuation. Ce riche ensemble de donn√©es facilite l'analyse d√©taill√©e et la compr√©hension des mod√®les de vente, des pr√©f√©rences des clients, de la g√©n√©ration de revenus et de l'√©valuation des performances, ce qui permet aux entreprises de prendre des d√©cisions et des strat√©gies √©clair√©es pour am√©liorer leur efficacit√© op√©rationnelle et la satisfaction des clients.

- **Nombre d‚Äôobservations**: 1001
- **Nombre de variables**: 20

- **[Source üöÄ](https://www.kaggle.com/datasets/antaesterlin/walmart-commerce-data)**

```{r,echo=FALSE, results='asis'}
data_description <- data.frame(
  Caract√©ristique = c("Row ID", "Order ID", "Order Date", "Ship Date", "Ship Mode", "Customer ID", "Customer Name", "Segment", "Country", "City", "State", "Postal Code", "Region", "Product ID", "Category", "Sub-Category", "Product Name", "Sales", "Quantity", "Discount", "Profit"),
  Description = c(
    "Identifiant de ligne(1, 2...)", 
    "Identifiant de la commande", 
    "Date √† laquelle la commande se passe", 
    "Date d‚Äôexp√©dition", 
    "Mode d'exp√©dition de la commande", 
    "ID du client associ√© √† la commande", 
    "Nom du client", 
    "Segment de client(entreprise, particulier)", 
    "Pays de cette commande", 
    "Ville o√π la commande a √©t√© exp√©di√©e", 
    "√âtats aux √©tats-unis", 
    "Code postal", 
    "R√©gion g√©ographique(l‚Äôest, l‚Äôouest...)", 
    "Identifiant du produit de cette commande", 
    "Cat√©gorie g√©n√©rale(comme Product Line)", 
    "Sous-cat√©gorie sp√©cifique du produit", 
    "Nom du produit", 
    "Montant des ventes de ce produit", 
    "Nombre d'unit√©s de ce produit", 
    "Montant de r√©duction √† ce produit", 
    "Montant de profit g√©n√©r√© par ce produit"
  ),
  Type = c("int", "String", "DATE(DD/MM/YYYY)", "DATE(DD/MM/YYYY)", "String", "String", "String", "String", "String", "String", "String", "int", "String", "String", "String", "String", "String", "float", "int", "float", "float")
)

# Utilisez la fonction kable pour cr√©er un tableau et ajouter des lignes de s√©paration verticales et des lignes
kable(data_description, col.names = c("Caract√©ristique", "Description", "Type"), format = "html") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F) %>%
  column_spec(1, border_right = TRUE) %>%
  column_spec(2, border_right = TRUE) %>%
  column_spec(3, border_right = TRUE) %>%
  row_spec(0, bold = TRUE, color = "white", background = "#4CAF50") %>%
  row_spec(1:nrow(data_description), hline_after = TRUE)
```


## 1.3 Plan d'analyse

Nous avons obtenu des informations compl√®tes sur les transactions de vente dans les grands supermarch√©s aux √âtats-Unis et au Myanmar respectivement, et effectuerons une analyse des donn√©es √† ce sujet. Voici quelques exemples d'analyse de requ√™tes sur cet ensemble de donn√©es :

### 1.3.1 Analyse des performances des ventes des supermarch√©s aux √âtats-Unis

1. **Dimension de la commande** : Quel est le montant moyen de la transaction et le taux de connexion de chaque commande ? Quelle est la relation entre le montant de la commande et le nombre d‚Äôarticles command√©s ? Quel est le prix total et le b√©n√©fice de chaque commande ?

   La relation entre le montant de la commande et le nombre d'articles dans la commande peut refl√©ter les caract√©ristiques du comportement d‚Äôachat du client. L'analyse de ces indicateurs peut aider les entreprises √† comprendre les caract√©ristiques et les tendances du comportement d'achat des clients, orientant ainsi les strat√©gies de vente et les activit√©s marketing de l'entreprise. Par exemple, s'il existe une forte corr√©lation positive entre le montant de la commande et le nombre de produits, l'entreprise peut prendre certaines mesures pour encourager les clients √† acheter davantage de produits, telles que la lancement de r√©ductions sur les forfaits, les ventes combin√©es, etc. Si le taux combin√© est faible, cela peut accro√Ætre la volont√© des clients d'acheter plusieurs produits par le biais de ventes li√©es, d'activit√©s promotionnelles, etc., augmentant ainsi les ventes.

2. **Dimension client** : 
  - Quelles sont les unit√©s de clients annuels moyens des supermarch√©s aux √âtats-Unis et au Myanmar ?
  - Quelle est la relation entre le nombre d‚Äôarticles achet√©s par un client en une seule transaction et le prix total ?
  - Comment classer les clients en fonction de leur comportement de consommation et formuler des strat√©gies correspondantes ?

   En tant que mod√®le d'analyse du comportement de consommation dans le domaine de la gestion de la relation client, le mod√®le RFM comprend trois variables : le moment de l'achat r√©cent R (R√©cence), la fr√©quence d'achat F (Fr√©quence) et le montant de l'achat M (Mon√©taire). En analysant le nombre de jours dans l'intervalle de temps, plus la valeur est petite, plus la probabilit√© d'achat r√©p√©t√© du client est grande et plus la valeur du client est √©lev√©e. F repr√©sente le nombre de fois que le client ach√®te des marchandises au cours de la p√©riode. Plus l'achat est √©lev√©. fr√©quence, plus le client est fid√®le. M repr√©sente le montant total de l'achat. Le montant de l'achat et la fid√©lit√© du client sont √©galement directement proportionnels, de sorte que la valeur du client peut √™tre obtenue en analysant le score RFM.

3. **Dimension du produit** : Le positionnement prix du produit est-il √©lev√© ou bas ? Quelle gamme de prix de produits se vend le mieux ? Quel niveau de prix g√©n√®re r√©ellement le plus de ventes ?

   Les ventes par segment r√©v√®lent non seulement les cat√©gories de produits les plus populaires, mais soulignent √©galement les domaines dans lesquels la demande du march√© n'est pas enti√®rement satisfaite.

4. **Dimension temporelle** : Quelle est la tendance des ventes pour chaque mois/jour et quelle est l'analyse du taux de croissance (ou du taux de d√©clin) ? Quel a pu √™tre l‚Äôimpact ?

   En analysant la r√©partition des donn√©es de vente sur diff√©rents jours, les entreprises peuvent optimiser la pr√©paration des stocks pour faire face aux pics de trafic client. L'analyse peut √©galement guider la planification de campagnes marketing, telles que l'offre de promotions sp√©ciales pendant les p√©riodes de baisse attendue des ventes.

5. **Dimension g√©ographique** : De quels pays proviennent principalement les clients ? Quel pays est le principal march√© √©tranger ? Dans quel pays les clients ont le pouvoir d'achat moyen le plus √©lev√© ?

   Cette analyse peut examiner les diff√©rences de ventes par r√©gion en raison de la densit√© de population, du pouvoir d'achat des clients ou de la commodit√© g√©ographique. Une analyse plus approfondie peut √©galement identifier les domaines dans lesquels il existe une plus grande demande pour un produit ou un service sp√©cifique, ce qui peut indiquer des opportunit√©s d'expansion ou une p√©n√©tration accrue du march√©.

### 1.3.2 Comparaison des supermarch√©s aux √âtats-Unis et au Myanmar

1. **Comparaison des prix et des marges b√©n√©ficiaires** : Comparer les prix des produits et les marges b√©n√©ficiaires dans les deux pays peut aider les entreprises √† comprendre la sensibilit√© aux prix et la comp√©titivit√© des diff√©rents march√©s.

2. **Part de march√© et potentiel de croissance** : En analysant les donn√©es de ventes, vous pouvez comprendre la part de march√© et le potentiel de croissance de l'entreprise sur les deux march√©s. Cela permet d'identifier et de prioriser les opportunit√©s d'expansion du march√©.

3. **Environnement √©conomique et comportement des consommateurs** : En comparant les donn√©es de ventes de deux pays, nous pouvons comprendre l'environnement √©conomique, le niveau de revenus des consommateurs et le pouvoir d'achat des pays respectifs, fournissant ainsi une r√©f√©rence pour la formulation de strat√©gies de march√©.


```{r include = FALSE}
data_usa <- read_csv("../data/superstore.csv")
head(data_usa)
```

```{r include = FALSE}
data_mya <- read_delim("../data/WalmartSQL repository.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
head(data_mya)
```

# 2 Exploration

## 2.1 Dimension de la commande

### 2.1.1 Calcul des montants moyens des transactions

```{r}
# Calculer le montant moyen des transactions pour chaque sous-cat√©gorie et les classer par ordre d√©croissant du montant moyen des transactions.
average_transaction <- data_usa %>%
  group_by(`Sub-Category`) %>%
  summarise(Average_Transaction_Amount = mean(Sales, na.rm = TRUE)) %>%
  arrange(desc(Average_Transaction_Amount))

# Cr√©er des diagrammes √† barres pour afficher les r√©sultats du tri
bar_plot <- ggplot(average_transaction, aes(x = reorder(`Sub-Category`, -Average_Transaction_Amount), y = Average_Transaction_Amount)) +
  geom_bar(stat = "identity", fill = "blue") + 
  labs(
    title = "Average Transaction Amount by Sub-Category",
    y = "Average Transaction Amount",
    x = "Sub-Category"
  ) +
  theme(axis.text.x = element_text(angle = 65, vjust = 0.6)) # Ajuster l'angle et la position des √©tiquettes de l'axe des x

bar_plot

```

- La sous-cat√©gorie Copieurs a la valeur moyenne de transaction la plus √©lev√©e, soit plus de 1 500, ce qui sugg√®re que les copieurs sont des articles plus rentables ou que les clients ont tendance √† choisir des produits de plus grande valeur lorsqu'ils font des achats.
- Les sous-cat√©gories Machines et Tables affichent √©galement des valeurs moyennes de transaction plus √©lev√©es, mais nettement inf√©rieures √† celles des Copieurs. Cela peut refl√©ter des strat√©gies de prix ou des habitudes d'achat des clients sur le march√© pour les produits de ces cat√©gories.
- La plupart des autres sous-cat√©gories, telles que la papeterie (attaches) et les √©tiquettes, ont une valeur moyenne de transaction inf√©rieure √† 500, ce qui peut s'expliquer par le prix unitaire inf√©rieur de ces articles ou par le fait que les clients les ach√®tent g√©n√©ralement en plus petites quantit√©s.
- Ce graphique montre clairement la valeur moyenne de transaction des diff√©rentes sous-cat√©gories, ce qui nous aide √† comprendre la performance du march√© et le comportement d'achat des clients pour chaque cat√©gorie. Pour les sous-cat√©gories dont le montant moyen des transactions est √©lev√©, les entreprises peuvent envisager des strat√©gies telles que l'offre de forfaits √† prix r√©duit ou de services de cr√©dit afin d'augmenter les ventes et d'am√©liorer la satisfaction des clients. Pour les sous-cat√©gories dont le montant moyen des transactions est plus faible, l'entreprise peut inciter les clients √† acheter davantage d'articles par le biais d'offres group√©es ou d'activit√©s promotionnelles.


### 2.1.2 Calcul du montant total de la commande et de la rentabilit√©

```{r}
# Tout d'abord, nous devons calculer le total des ventes et des b√©n√©fices pour chaque sous-cat√©gorie.
category_summary <- data_usa %>%
  group_by(`Sub-Category`) %>%
  summarise(Total_Sales = sum(Sales, na.rm = TRUE),
            Total_Profit = sum(Profit, na.rm = TRUE)) %>%
  arrange(desc(Total_Sales)) # Par ordre d√©croissant des ventes totales

# Cr√©er un diagramme √† barres bi-axial
p <- ggplot(category_summary, aes(x = reorder(`Sub-Category`, Total_Sales))) +
  geom_bar(aes(y = Total_Sales, fill = "Total Sales"), stat = "identity", position = "dodge") +
  geom_bar(aes(y = Total_Profit, fill = "Total Profit"), stat = "identity", position = "dodge") +
  scale_y_continuous(
    "Total Sales",
    sec.axis = sec_axis(~ ., name = "Total Profit", breaks = seq(-50000, 50000, by = 10000))
  ) +
  labs(title = "Total Sales and Profit by Sub-Category",
       x = "Sub-Category", y = "Total Sales",
       fill = "Bar Type") + # Ajouter une l√©gende pour le type de barre
  theme_minimal() +
  theme(
    legend.position = "right",
    axis.text.x = element_text(angle = 65, vjust = 0.6)
  )

# Personnaliser les couleurs des barres
p + scale_fill_manual(values = c("Total Sales" = "steelblue", "Total Profit" = "firebrick"))

```

- La sous-cat√©gorie des t√©l√©phones a √©t√© la plus performante en termes de ventes totales, ce qui indique que cette cat√©gorie est tr√®s populaire sur le march√© et qu'elle enregistre de bons r√©sultats.
- La sous-cat√©gorie Copieurs a √©t√© la plus performante en termes de b√©n√©fices et peut avoir eu des marges plus √©lev√©es.
- Les sous-cat√©gories Fournitures et Tables ont enregistr√© des pertes, comme le montre le graphique en rouge, ce qui pourrait signifier que le contr√¥le des co√ªts dans ces cat√©gories doit √™tre am√©lior√© ou que les strat√©gies de vente doivent √™tre ajust√©es.
- La plupart des sous-cat√©gories ont r√©alis√© un b√©n√©fice, mais le niveau de b√©n√©fice varie, ce qui peut refl√©ter les marges et les structures de co√ªts des diff√©rents produits.


### 2.1.3 Part de march√© et potentiel de croissance

#### 2.1.3.1  Calcul de la part de march√©

```{r}
#USA
# Calculer la part de march√©
market_share <- data_usa %>%
  group_by(`Sub-Category`) %>%
  summarise(total_sales = sum(Sales, na.rm = TRUE)) %>%
  mutate(market_share = total_sales / sum(total_sales) * 100) %>%
  arrange(desc(market_share))

# : : Tracer des histogrammes de parts de march√©
market_share_plot <- ggplot(market_share, aes(x = reorder(`Sub-Category`, -market_share), y = market_share, fill = `Sub-Category`)) +
  geom_bar(stat = "identity") +
  labs(title = "USA Market Share by Sub-Category", x = "Sub-Category", y = "Market Share (%)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

market_share_plot

```
- La sous-cat√©gorie des t√©l√©phones arrive en t√™te en termes de parts de march√©, avec une part de plus de 15 %, ce qui sugg√®re une forte demande de produits t√©l√©phoniques sur le march√© am√©ricain.
- Les sous-cat√©gories des chaises et des classeurs suivent avec des parts de march√© d'un peu moins de 10 % chacune, ce qui refl√®te probablement la demande constante de mobilier et de fournitures de bureau sur le march√©.
- D'autres sous-cat√©gories telles que le stockage, les copieurs et les appareils m√©nagers ont des parts de march√© plus faibles, mais cela ne signifie pas qu'elles n'ont pas de potentiel de croissance. La faible part de march√© peut √™tre due √† une forte concurrence sur le march√© ou √† la nature du segment.



```{r echo=FALSE}
# Calculer les ventes totales et la part de march√© pour chaque ligne de produits
market_share_mya <- data_mya %>%
  group_by(product_line) %>%
  summarise(Total_Sales = sum(total, na.rm = TRUE)) %>%
  mutate(Market_Share = Total_Sales / sum(Total_Sales) * 100) %>%
  arrange(desc(Market_Share))

# Visualiser la part de march√© sous forme de diagramme circulaire et montrer les pourcentages
ggplot(market_share_mya, aes(x = "", y = Market_Share, fill = product_line)) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start = 0) +
  theme_void() +
  theme(legend.title = element_blank()) +
  labs(fill = "Product Line") +
  guides(fill = guide_legend(reverse = TRUE)) +
  labs(title = "Market Share by Product Line in Myanmar") +
  geom_text(aes(label = sprintf("%.1f%%", Market_Share)), position = position_stack(vjust = 0.5))

```

- La ligne de produits Sports et voyages d√©tient une part de march√© de 17,1 %, ce qui indique une demande stable pour les produits li√©s aux activit√©s de loisirs au Myanmar.
- Les accessoires √©lectroniques et les accessoires pour la maison et le style de vie d√©tiennent chacun 16,8 % du march√©, ce qui d√©montre l'importance de ces produits dans la vie de tous les jours.
- Le secteur de la sant√© et de la beaut√© suit avec 16,7 %, refl√©tant l'int√©r√™t des consommateurs pour les produits de soins personnels et de bien-√™tre.
- Les produits alimentaires et les boissons sont l√©g√®rement en t√™te avec 17,4 %, ce qui est peut-√™tre li√© aux besoins de base du mode de vie et aux habitudes de consommation.
- Les accessoires de mode, avec 15,2 %, ont la part la plus faible de toutes les cat√©gories, mais restent un segment de march√© √† ne pas n√©gliger.

---

## 2.2 Dimension du client

```{r}
# Obtenir le quart
get_custom_quarter <- function(date) {
  month <- as.POSIXlt(date)$mon + 1
  if (month %in% 1:3) {
    return("Q1")
  } else if (month %in% 4:6) {
    return("Q2")
  } else if (month %in% 7:9) {
    return("Q3")
  } else if (month %in% 10:12) {
    return("Q4")
  } else {
    return("Unknown")
  }
}

# Obetnir semaine
get_custom_week <- function(date) {
  week_of_year <- strftime(date, format = "%U")
  return(week_of_year)
}

client_usa <- data_usa %>%
  select(`Customer ID`, `Order Date`, `Order ID`, Sales, Quantity) %>%
  group_by(`Customer ID`, `Order Date`, `Order ID`) %>%
  summarise(quantity = sum(Quantity, na.rm = TRUE),
            total = sum(Sales, na.rm = TRUE)) %>%
  ungroup() %>%
  transmute(customer_id = `Customer ID`,
            order_id = `Order ID`,
            order_date = as.Date(`Order Date`, format = "%d-%m-%y"),
            quantity = quantity,
            total = total)

client_usa$quarter <- sapply(client_usa$order_date, get_custom_quarter)

client_usa$week <- sapply(client_usa$order_date, get_custom_week)

client_mya <- data_mya %>%
  select(quantity, total, dtme, invoice_id) %>%
  transmute(order_id = invoice_id,
            order_date = dtme,
            quantity = quantity,
            total = total)

client_mya$quarter <- sapply(client_mya$order_date, get_custom_quarter)

client_mya$week <- sapply(client_mya$order_date, get_custom_week)
```

### 2.2.1 Quelles sont les unit√©s de clients annuels moyens des supermarch√©s aux √âtats-Unis et au Myanmar ?

```{r}
client_unit_year_usa <- client_usa %>%
  group_by(year = format(order_date, "%Y")) %>%
  summarise(client_unit = sum(quantity) / n())

client_unit_year_mya <- client_mya %>%
  group_by(year = format(order_date, "%Y")) %>%
  summarise(client_unit = sum(quantity) / n())
```

```{r}

max_y <- (max(max(client_unit_year_usa$client_unit), max(client_unit_year_mya$client_unit)) %/% 10 + 1) * 10

bar_client_unit_usa <- ggplot(client_unit_year_usa, aes(x = year, y = client_unit)) +
  geom_bar(stat = "identity", fill = brewer.pal(3, "Set1")[1], alpha = 0.7, width = 0.5) +
  labs(title = "Average Client Unit by Year (USA)", x = "Year", y = "Average Client Unit (number of items)") +
  coord_cartesian(ylim = c(0, max_y)) +
  scale_y_continuous(expand = c(0, 0)) + 
  theme(plot.title = element_text(size = 12)) + 
  geom_text(aes(label = round(client_unit, digits = 1)), 
              size = 3,
              vjust = -0.5,
              color = "black")
  

bar_client_unit_mya <- ggplot(client_unit_year_mya, aes(x = year, y = client_unit)) +
  geom_bar(stat = "identity", fill = brewer.pal(3, "Set1")[2], alpha = 0.7, width = 0.5) +
  labs(title = "Average Client Unit by Year (MYA)", x = "Year", y = "Average Client Unit (number of items)") +
  coord_cartesian(ylim = c(0, max_y)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme(plot.title = element_text(size = 12)) + 
  geom_text(aes(label = round(client_unit, digits = 1)), 
              size = 3,
              vjust = -0.5,
              color = "black")


grid.arrange(bar_client_unit_usa, bar_client_unit_mya, nrow = 1)

```
**"Client unit"** se r√©f√®re au nombre moyen d'articles achet√©s par un client en une seule transaction.

**Analyse des Graphiques**:

**USA** : Les unit√©s moyennes de clients varient l√©g√®rement d'ann√©e en ann√©e, avec une tendance √† la baisse de 2014 √† 2017.

**MYA** : Pour l'ann√©e 2019, l'unit√© moyenne de clients est de 5,5 articles, ce qui est plus bas que les unit√©s moyennes observ√©es aux √âtats-Unis pour les ann√©es donn√©es.

### 2.2.2 Quelle est la relation entre le nombre d‚Äôarticles achet√©s par un client en une seule transaction et le prix total ?

```{r}
client_mya_total_quantity <- client_mya %>%
  select(total = total,
         quantity = quantity)

client_usa_total_quantity <- client_usa %>%
  filter(total <= 1500 &
           total > quantile(total, 0.05) & 
           total < quantile(total, 0.95) & 
           # quantity <= 10 &
           quantity > quantile(quantity, 0.05) & 
           quantity < quantile(quantity, 0.95) ) %>%
  select(total = total,
         quantity = quantity)

boxplot_usa <-ggplot(data = client_usa_total_quantity, mapping = aes(x = quantity, y = total)) + 
  geom_boxplot(aes(group = cut_width(quantity, 1)), fill = brewer.pal(3, "Set1")[1], alpha = 0.7) +
  labs(title = "Relationship between Quantity and Total (USA)",
       x = "quantity",
       y = "total ($)") +
  scale_x_continuous(breaks = seq(0, 50, by = 1), limits = c(2.5, 18.5)) +
  scale_y_continuous(limits = c(0, 1200)) + 
  theme(plot.title = element_text(size = 10))

boxplot_mya <- ggplot(data = client_mya_total_quantity, mapping = aes(x = quantity, y = total)) + 
  geom_boxplot(aes(group = cut_width(quantity, 1)), fill = brewer.pal(3, "Set1")[2], alpha = 0.7) +
  labs(title = "Relationship between Quantity and Total (MYA)",
       x = "quantity",
       y = "total ($)")+
  scale_x_continuous(breaks = seq(0, 10, by = 1), limits = c(2.5, 10.5)) + 
  theme(plot.title = element_text(size = 10))

grid.arrange(boxplot_usa, boxplot_mya, ncol = 2)
```
**Analyse des Graphiques**:

**USA**

  - Le graphique de gauche (USA) montre une augmentation g√©n√©rale du prix total avec l'augmentation de la quantit√© d'articles achet√©s.
  - Cependant, la dispersion est plus importante pour les petites quantit√©s (2 √† 7 articles), avec des valeurs totales qui varient largement.
  - Pour des quantit√©s plus grandes (√† partir de 10 articles), le prix total semble se stabiliser autour de 500 √† 750 $, mais avec une plus grande variabilit√© pour les tr√®s grandes quantit√©s (16-19 articles).

**MYA**

  - Le graphique de droite (MYA) montre une augmentation plus lin√©aire et plus claire du prix total avec l'augmentation de la quantit√© d'articles achet√©s.
  - La m√©diane du prix total augmente r√©guli√®rement avec la quantit√©, ce qui indique une relation plus directe et proportionnelle entre la quantit√© et le prix total par rapport aux USA.
  - La variabilit√© du prix total augmente √©galement avec la quantit√©, mais de mani√®re plus uniforme par rapport au graphique des USA.

**Conclusion**

  - **Relation Positive** : Dans les deux pays, il y a une relation positive entre la quantit√© d'articles achet√©s et le prix total. Plus un client ach√®te d'articles en une seule transaction, plus le prix total a tendance √† √™tre √©lev√©.
  - **Variabilit√©** : La variabilit√© du prix total est plus marqu√©e dans le cas des USA, surtout pour des petites et grandes quantit√©s, alors que pour la Malaisie, l'augmentation est plus lin√©aire et la variabilit√© augmente de mani√®re plus pr√©visible.
  - **Diff√©rences R√©gionales** : Les clients aux USA montrent une plus grande dispersion des prix pour une m√™me quantit√© d'articles par rapport aux clients en Malaisie, ce qui peut √™tre d√ª √† des facteurs tels que les diff√©rences de prix des articles, les promotions ou les comportements d'achat.

### 2.2.3 Comment classer les clients en fonction de leur comportement de consommation et formuler des strat√©gies correspondantes ?

```{r}
assign_label <- function(value, median_value) {
  ifelse(value <= median_value, "Low", "High")
}

min_max_normalize <- function(x) {
  (x - min(x)) / (max(x) - min(x))
}

max_date <- max(client_usa$order_date)

rfm_data <- client_usa %>%
  group_by(customer_id) %>%
  summarise(
    total_days = as.numeric(difftime(max(order_date), min(order_date), units = "days")),
    recency = as.numeric(min(difftime(max_date, order_date, units = "days"), na.rm = TRUE)),
    frequency = n(),
    monetary = sum(total, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  filter(recency < 547 & total_days < 547)

rfm_data <- rfm_data %>%
  mutate(
    r_score = ntile(-recency, 2),
    f_score = ntile(frequency, 2),
    m_score = ntile(monetary, 2)
  )

rfm_data <- rfm_data %>%
  mutate(
    segment = paste0("R", r_score, "F", f_score, "M", m_score)
  )

rfm_to_customer_segment <- function(rfm_label) {
  segment_map <- c(
    "R2F1M1" = "New Customers",
    "R2F1M2" = "Important Deepening Customers", 
    "R2F2M1" = "Potential customers",
    "R2F2M2" = "Important Value Customers",
    "R1F1M1" = "Churned Customers",
    "R1F1M2" = "Important Retention Customers",
    "R1F2M1" = "Average Maintenance Customers",
    "R1F2M2" = "Important Win-Back Customers"
  )

  customer_segment <- segment_map[rfm_label]
  
  return(customer_segment)
}

rfm_data$segment <- rfm_to_customer_segment(rfm_data$segment)

```

```{r}

plot_ly(x = rfm_data$recency,
        y = rfm_data$frequency,
        z = rfm_data$monetary,
        type = "scatter3d",
        mode = "markers",
        color = rfm_data$segment,
        hoverinfo = "text",
        text = ~paste("Customer ID:", rfm_data$customer_id, "<br>",
                      "Recency:", rfm_data$recency, "<br>",
                      "Frequency:", rfm_data$frequency, "<br>",
                      "Monetary:", rfm_data$monetary),
        marker = list(size = 5)) %>% 
  layout(
    scene = list(
      xaxis = list(title = "Recency(days)"),
      yaxis = list(title = "Frequency(days)"),
      zaxis = list(title = "Monetary($)")
    ),
    title = "Model RMF"
  )

```


```{r}
segment_counts <- table(rfm_data$segment)
segment_percent <- segment_counts / sum(segment_counts) * 100

segment_summary <- data.frame(segment = names(segment_counts), segment_percent = segment_percent)

ggplot(segment_summary, aes(x = "", y = segment_percent, fill = segment)) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar(theta = "y") +
  labs(title = "RFM Segmentation",
       fill = "Segment") +
  scale_fill_manual(values = brewer.pal(n = length(unique(rfm_data$segment)), name = "Set2")) +
  theme_void() +
  theme(legend.position = "right") +
  geom_text(aes(label = paste0(round(segment_percent), "%")), 
            position = position_stack(vjust = 0.5))
```


Le mod√®le RFM (R√©cence, Fr√©quence, Mon√©taire) est une technique de segmentation des clients utilis√©e en marketing pour analyser et regrouper les clients en fonction de leurs comportements d'achat. 

- **R√©cence (R)** : date √† laquelle un client a effectu√© un achat (jours depuis le dernier achat). Calculez le nombre de jours depuis le dernier achat du client. Attribuez un score en fonction de la date d'achat, les achats plus r√©cents obtenant des scores plus √©lev√©s.
- **Fr√©quence (F)** : fr√©quence √† laquelle un client effectue un achat (jours √† quelle fr√©quence faire ses achats). Comptez le nombre total d'achats effectu√©s par le client au cours d'une p√©riode de temps sp√©cifi√©e. Attribuez un score en fonction du nombre d'achats, avec des acheteurs plus fr√©quents. obtenir des scores plus √©lev√©s.
- **Mon√©taire (M)** : combien d'argent un client d√©pense (montant de l'achat en dollars am√©ricains). Additionnez le montant total d'argent que le client a d√©pens√© au cours d'une p√©riode de temps sp√©cifi√©e. Attribuez un score en fonction des d√©penses totales, les d√©pensiers les plus √©lev√©s obtenant des scores plus √©lev√©s.

Chaque client est affect√© √† un groupe RFM, qui repr√©sente sa performance sur ces trois dimensions. Voici une description de chaque cat√©gorie :

1. **R2F1M1 - New Customers**
  - **Description** : Il s'agit de clients qui viennent d'effectuer leur premier achat r√©cemment. Leur fr√©quence d'achat et leur montant sont tous deux faibles.
  - **Caract√©ristiques** : Puisqu‚Äôil s‚Äôagit de nouveaux clients, ils doivent devenir des clients fid√®les gr√¢ce √† un bon service et des strat√©gies marketing appropri√©es.
2. **R2F1M2 - Important Deepening Customers**
  - **Description** : Ces clients ont r√©cemment effectu√© leur premier achat et, bien que la fr√©quence d'achat soit faible, le montant de l'achat est √©lev√©.
  - **Caract√©ristiques** : ces clients ont un potentiel √©lev√© et ont besoin de mieux comprendre leurs besoins et de fournir des produits et services personnalis√©s pour augmenter leur fr√©quence d'achat.
3. **R2F2M1 - Potential Customers**
  - **Description** : Ces clients ont r√©cemment effectu√© des achats, avec une fr√©quence d'achat √©lev√©e, mais un faible montant par achat.
  - **Caract√©ristiques** : ces clients ont une fr√©quence d'interaction √©lev√©e et le montant de leurs achats peut √™tre augment√© en recommandant des produits connexes et en am√©liorant l'exp√©rience client.
4. **R2F2M2 - Important Value Customers**
  - **Description** : Ces clients ont r√©cemment effectu√© des achats fr√©quents et disposent d'un montant √©lev√©.
  - **Caract√©ristiques** : Ce sont les clients les plus pr√©cieux et doivent √™tre entretenus et pris en charge, avec des offres exclusives et des services de qualit√© pour maintenir leur fid√©lit√©.
5. **R1F1M1 - Churned Customers**
  - **Description** : Ces clients n'ont pas effectu√© d'achats depuis longtemps et ont une fr√©quence et un montant d'achat faibles.
  - **Caract√©ristiques** : ces clients risquent de perdre leur client√®le et devront peut-√™tre √™tre r√©activ√©s gr√¢ce √† des promotions sp√©ciales ou √† des strat√©gies de r√©activation.
6. **R1F1M2 - Important Retention Customers**
  - **Description** : Ces clients n'ont pas effectu√© d'achats depuis longtemps, mais ils avaient auparavant des montants d'achat √©lev√©s.
  - **Caract√©ristiques** : Ces clients √©taient autrefois des clients de grande valeur et ont besoin d'√™tre restimul√©s gr√¢ce √† des soins particuliers et √† des strat√©gies promotionnelles personnalis√©es.
7. **R1F2M1 - Average Maintenance Customers**
  - **Description** : Ces clients ont un comportement d'achat moyen, avec une fr√©quence √©lev√©e mais un faible montant.
  - **Caract√©ristiques** : Ces clients constituent un groupe de clients relativement stable et leur comportement d'achat peut √™tre maintenu gr√¢ce √† une interaction continue et des offres mod√©r√©es.
8. **R1F2M2 - Important Win-Back Customers**
  - **Description** : Ces clients ont une fr√©quence d‚Äôachat √©lev√©e et un montant d‚Äôachat √©lev√©, mais n‚Äôont effectu√© aucun achat r√©cemment.
  - **Fonctionnalit√©s** : Ces clients √©taient autrefois des clients tr√®s importants, et vous pouvez essayer de les r√©activer en d√©veloppant des strat√©gies de r√©cup√©ration cibl√©es (telles que des offres sp√©ciales et des recommandations personnalis√©es).

**Analyse des Graphiques**:

Le pie chart montre que dans les supermarch√©s am√©ricains √©tudi√©s, les trois types de clients(New Customers, Important Win-Back Customers, Important Value Customers) repr√©sentent la plus grande proportion, donc sur la base de l'introduction pr√©c√©dente, nous pouvons adopter les m√©thodes de marketing correspondantes.

---

## 2.3 Dimension de "produit" au march√© Am√©ricain

We want to clean the data in the dataset US

```{r}
product_us = data_usa %>%
  select(`Product ID`, Category, `Sub-Category`, Sales, Quantity, Profit) %>% #choose the concerned fields
  group_by(Category, `Sub-Category`, `Product ID`, Profit) %>% #group all the lines by the 3 fields
  summarise(quantity = sum(Quantity, na.rm = TRUE),
            total = sum(Sales, na.rm = TRUE),
            unit_price = total / quantity) %>% #delete the null cell and calculate the unit_price of a product, the sales and the total income
  ungroup() %>%
  transmute(product_id = `Product ID`,
            category = `Category`,
            sub_category = `Sub-Category`,
            unit_price = unit_price,
            quantity = quantity,
            total = total,
            profit = Profit) #form a new table and use it later
#include the profit, and then compare it with the profit in the table mya

product_us #print the data frame 
```

Nous voulons nettoyer les donn√©es de l'ensemble de donn√©es mya. Nous conservons les champs suivants : product_id, category, unit_price, quantity, total, profit. Une chose √† noter est que le ¬´ invoice_id ¬ª repr√©sente le ¬´ product_id ¬ª.

```{r}
product_mya = data_mya %>%
  select(product_line, invoice_id, unit_price, quantity, total, gross_income, gross_margin_pct) %>% #choose the concerned fields
  group_by(product_line, invoice_id, unit_price) %>% #group all the lines by the 3 fields
  summarise(quantity = sum(quantity, na.rm = TRUE), 
            total = sum(total, na.rm = TRUE), 
            profit = gross_income * gross_margin_pct) %>% #"na.rm" deletes the null cell and calculate the total income and the sales  
  ungroup() %>%
  transmute(product_id = invoice_id,
            category = product_line,
            unit_price = unit_price,
            quantity = quantity,
            total = total,
            profit = profit
            ) #form a new table and use it later

product_mya
```

### 2.3.1 La relation entre les ventes et le prix 

Nous pouvons voir que les produits moins chers que 500\$ se vendent mieux. En d'autres termes, la fourchette de prix 0-500\$ est la meilleure. Mais en fait, la baisse du prix ne g√©n√®re pas le plus de ventes. Il y a beaucoup de points rassembl√©s dans le coin inf√©rieur gauche.


```{r}
ggplot(product_us, aes(x = unit_price, y = quantity)) +
  geom_point(color = "salmon") +
  labs(title = "The relation between the sales and the price (US)",
       x = "product_unit_price ($)",
       y = "sales (pcs)") +
  theme_minimal() +
  scale_x_continuous(breaks = seq(0, 3500, by = 200)) #Modify the x-axis scale range and interval, to make it easier to read.

  
```

### 2.3.2 La distribution des prix et des b√©n√©fices 

#### 2.3.2.1 Sensibilit√© au prix : la distribution et les tendances des prix  


Sur les march√©s o√π la sensibilit√© au prix est √©lev√©e, on observe g√©n√©ralement une large distribution des prix des produits et des marges b√©n√©ficiaires plus faibles, car les consommateurs ont tendance √† pr√©f√©rer les produits moins chers. √Ä l'instar du march√© am√©ricain

√Ä l'inverse, sur les march√©s o√π la sensibilit√© au prix est faible, la distribution des prix des produits est g√©n√©ralement plus √©troite et les marges b√©n√©ficiaires plus √©lev√©es. C'est le cas du march√© du MYA.


#### 2.3.2.2 La comp√©titivit√© : la distribution et les tendances des b√©n√©fices 


Sur les march√©s tr√®s concurrentiels, les b√©n√©fices sur les produits ont tendance √† √™tre concentr√©s, car les concurrents s'efforcent de baisser les prix pour attirer les consommateurs, r√©duisant ainsi les marges b√©n√©ficiaires des entreprises. √Ä l'instar du march√© am√©ricain

Sur les march√©s moins concurrentiels, les b√©n√©fices sur les produits ont tendance √† √™tre plus largement r√©partis, car les entreprises disposent d'une plus grande flexibilit√© en mati√®re de fixation des prix et peuvent maintenir des marges b√©n√©ficiaires relativement plus √©lev√©es. Tout comme le march√© du MYA.

```{r}
ggplot()+
  geom_point(data = product_us, aes(x = unit_price, y = profit, color = 'US'))+
  geom_point(data = product_mya, aes(x = unit_price, y = profit, color = 'MYA'))+
  labs(title = "The distribution of the unit_price and the profit in 2 countries (US and MYA)",
       x = "product_unit_price",
       y = "profit") +
  geom_smooth(data = product_us, aes(x = unit_price, y = profit), method = "lm", se = FALSE, color = "blue") +
  geom_smooth(data = product_mya, aes(x = unit_price, y = profit), method = "lm", se = FALSE, color = "red") +
  theme_minimal() +
  xlim(0, 300) +  # limit the range of x
  ylim(-250, 250)  
```

## 2.4 dimension temporelle
Dans la dimension temporelle, nous devons analyser les questions suivantes concernant les donn√©es des supermarch√©s am√©ricains:

Quelle est la tendance des ventes chaque mois et quelle est l‚Äôanalyse du taux de croissance (ou du taux de baisse)? Quel a pu √™tre l‚Äôimpact ?

### 2.4.1 tendances des ventes mensuelles
Afin de voir clairement la tendance des ventes mensuelles, nous allons tracer un graphique des ventes mensuelles¬†:

```{r}
# Nettoyage des donn√©es: convertir le format de date
data_usa$`Order Date` <- dmy(data_usa$`Order Date`)
data_usa$`Ship Date` <- dmy(data_usa$`Ship Date`)

# Convertir la date au format "ann√©e-mois-jour"
data_usa$`Order Date` <- format(data_usa$`Order Date`, "%Y-%m-%d")
data_usa$`Ship Date` <- format(data_usa$`Ship Date`, "%Y-%m-%d")

```


```{r, echo=FALSE, results='hide'}
# Cr√©er un champ YearMonth pour le regroupement
data_usa$YearMonth <- format(as.Date(data_usa$`Order Date`), "%Y-%m")
# V√©rifiez s'il n'y a pas de donn√©es
sum(is.na(data_usa$YearMonth))
if (any(is.na(data_usa$YearMonth))) {
  stop("There are NA values in the 'YearMonth' column after conversion. Check original data.")
}

# R√©sumer les donn√©es dans la table Monthly_sales
monthly_sales <- data_usa %>%
  group_by(YearMonth) %>%
  summarise(
    TotalProfit = sum(Profit, na.rm = TRUE),
    TotalQuantity = sum(Quantity, na.rm = TRUE),
    TotalSales = sum(Sales, na.rm = TRUE)
  )

# Convertissez YearMonth en objet date, assurez-vous qu'il n'y a pas d'erreurs
monthly_sales$YearMonth <- as.Date(paste0(monthly_sales$YearMonth, "-01"))

```

```{r}
# Utiliser ggplot pour dessiner un graphique lin√©aire - Profit et Quantity
p1 <- ggplot(monthly_sales, aes(x = YearMonth)) +
  geom_line(aes(y = TotalProfit, colour = "Profit"), size = 1) +
  geom_line(aes(y = TotalQuantity, colour = "Quantity"), size = 1) +
  scale_x_date(date_labels = "%Y", date_breaks = "1 year", minor_breaks = "1 month") +
  scale_y_continuous(labels = scales::dollar_format(prefix = "$")) +
  scale_color_manual(values = c(Profit = "goldenrod1", Quantity = "deepskyblue4")) +
  labs(x = "Year and Month", y = "Value (in $)", title = "Monthly Profit and Quantity Trends") +
  theme_minimal() +
  theme(legend.title = element_blank(),
        legend.position = "right",
        axis.text.x = element_text(angle = 45, hjust = 1),
        panel.grid.minor = element_line(colour = "gray80", linetype = "dashed"))

# Utilisez ggplot pour dessiner un graphique lin√©aire - SumPrice
p2 <- ggplot(monthly_sales, aes(x = YearMonth, y = TotalSales, colour = "SumPrice")) +
  geom_line(size = 1) +
  scale_x_date(date_labels = "%Y", date_breaks = "1 year", minor_breaks = "1 month") +
  scale_y_continuous(labels = scales::dollar_format(prefix = "$")) +
  scale_color_manual(values = c(SumPrice = "darkorange1")) +
  labs(x = "Year and Month", y = "Value (in $)", title = "Monthly Sales Trends") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1),
        panel.grid.minor = element_line(colour = "gray80", linetype = "dashed"))

# Arrange the plots with some space between them
#grid.arrange(p1, p2, ncol = 1, heights = c(1, 1), padding = unit(2, "cm"))

# Imprimer des graphiques
print(p1)
print(p2)
```
Comme le montre la figure ci-dessus, il s'agit du graphique chronologique du volume des ventes et des b√©n√©fices de 2014 √† 2017, et du graphique chronologique des ventes de 2014 √† 2017. Comme le montre la figure, les ventes et le volume des ventes suivent une tendance √† la hausse, et il existe des fluctuations saisonni√®res √©videntes au cours des quatre ann√©es, les meilleures conditions de vente √©tant enregistr√©es en juillet, octobre et novembre. Avec une activit√© en croissance constante, nous esp√©rons pr√©dire les ventes futures sur la base des ventes historiques sur 4 ans, afin de proc√©der √† de futurs ajustements et configurations strat√©giques.

### 2.4.2 Mod√®le de s√©rie chronologique
#### 2.4.2.1 Principes du mod√®le de s√©ries chronologiques
La pr√©vision de s√©ries chronologiques implique principalement d'organiser un ensemble de valeurs d'observation dans une s√©rie chronologique, traitant ainsi la s√©rie chronologique et utilisant des mod√®les math√©matiques pour l'√©tendre davantage afin de pr√©dire la tendance de d√©veloppement √† l'avenir.

Les donn√©es sur les ventes des supermarch√©s pr√©sent√©es dans cet article sont des donn√©es chronologiques √©videntes de janvier 2014 √† d√©cembre 2017. Elles pr√©sentent deux caract√©ristiques: l'une est que le chiffre ci-dessus montre que ses ventes pr√©sentent des changements cycliques saisonniers, et l'autre est que les ventes ont une tendance √† la croissance stable. , la m√©thode des s√©ries chronologiques peut donc √™tre utilis√©e pour pr√©dire les ventes futures sur la base de 4 ann√©es de donn√©es de ventes historiques.

#### 2.4.2.2 Processus de mod√©lisation
Pour utiliser le mod√®le ARIMA d'analyse de s√©ries chronologiques pour les pr√©visions de ventes trimestrielles en 2018, nous devons d'abord cr√©er un objet de s√©rie chronologique, puis s√©lectionner les param√®tres, l'ajustement et les pr√©visions du mod√®le ARIMA appropri√©s.

```{r}
# Extraire l'ann√©e et le mois
data_usa$Year <- year(data_usa$`Order Date`)
data_usa$Quarter <- quarter(data_usa$`Order Date`, with_year = TRUE)

# Agr√©ger les donn√©es au niveau du trimestre
quarterly_sales <- data_usa %>%
  group_by(Quarter) %>%
  summarise(TotalSales = sum(Sales))

# Cr√©ez un objet de s√©rie chronologique, les donn√©es commencent √† partir de 2014, la fr√©quence est de 4 (donn√©es trimestrielles)
sales_ts <- ts(quarterly_sales$TotalSales, start = c(2014, 1), frequency = 4)

# Utilisation de l'ajustement automatique du mod√®le ARIMA
fit <- auto.arima(sales_ts)

# Informations r√©capitulatives sur la vue du mod√®le
summary(fit)

# Pr√©visions de ventes 2018 (4 trimestres)
forecast <- forecast(fit, h = 4)

# Afficher les r√©sultats de la pr√©diction
print(forecast)


```
Les donn√©es du tableau de pr√©visions montrent les √©l√©ments suivants:

Pr√©visions ponctuelles: repr√©sente les ventes moyennes pr√©vues pour chaque trimestre.
Lo 80 et Hi 80:indiquent l'intervalle de confiance de 80%, ce qui signifie que la valeur pr√©dite a une probabilit√© de 80% de se situer dans cette plage.
Lo 95 et Hi 95:indiquent l'intervalle de confiance de 95%, ce qui signifie que la valeur pr√©dite a une probabilit√© de 95% de se situer dans cette plage.


#### 2.4.2.3 Les images suivantes sont des r√©sultats de pr√©diction¬†:

```{r}
# Visualisez les r√©sultats des pr√©dictions
autoplot(forecast) + 
  labs(title = "Forecasted Quarterly Sales for 2018", x = "Quarter", y = "Sales")
```

Nous analyserons le graphique pr√©visionnel g√©n√©r√©, qui repr√©sente les ventes r√©elles de 2014 √† 2017 et les ventes pr√©vues pour 2018. L'image est discontinue entre le quatri√®me trimestre 2017 et le premier trimestre 2018 car la valeur pr√©dite est une valeur de plage et il est impossible de trouver un point pr√©cis √† connecter dans un graphique lin√©aire, mais cela n'affecte pas la lecture. Il est facile de voir sur l'image¬†:

Les donn√©es de ventes r√©elles de 2014 √† 2017 ont montr√© des fluctuations saisonni√®res √©videntes, qui peuvent √™tre li√©es aux activit√©s de vente ou au comportement d'achat des consommateurs au cours de saisons sp√©cifiques.

Les pr√©visions pour 2018 montrent une tendance √† la hausse des ventes, mais l‚Äôincertitude des pr√©visions augmente avec le temps, ce qui se refl√®te dans l‚Äô√©largissement de la zone ombr√©e.

Comme le montre le graphique, m√™me si la tendance g√©n√©rale est √† la hausse, la croissance des ventes semble avoir ralenti certaines ann√©es, comme de 2016 √† 2017.

Cela peut √™tre d√ª √† plusieurs facteurs¬†:

-Saturation du march√© : √† mesure que le march√© devient satur√©, la croissance des ventes ralentira naturellement.

-Concurrence intensifi√©e : L'entr√©e de nouveaux concurrents ou les strat√©gies concurrentielles des concurrents existants peuvent affecter les ventes.

-Impact √©conomique¬†: les changements dans les conditions macro√©conomiques, comme une r√©cession ou une baisse de confiance des consommateurs, peuvent √©galement affecter les ventes.


#### 2.4.2.4 SuggestionÔºö

En r√©ponse √† ces tendances observ√©es et aux changements potentiels du march√©, la direction des supermarch√©s peut envisager les strat√©gies suivantes:

1.Diversifier les produits et services: attirez plus de clients et r√©pondez √† la concurrence en introduisant de nouveaux produits ou services.

2.Renforcer les activit√©s de promotion et de marketing : Surtout pendant les p√©riodes de faibles ventes, stimuler la consommation gr√¢ce √† des promotions et des activit√©s de marketing cibl√©es.

3.Optimisez la gestion des stocks: ajustez les stocks en fonction des tendances des ventes et des changements saisonniers pour r√©duire le risque de surstocks et de ruptures de stock.

4.√âtudes de march√© et de consommation: mener en permanence des √©tudes de march√© et sur le comportement des consommateurs pour mieux comprendre les changements dans la demande du march√© et les pr√©f√©rences des consommateurs.

Gr√¢ce √† ces analyses et strat√©gies, les supermarch√©s peuvent mieux s'adapter aux changements du march√©, optimiser leur efficacit√© op√©rationnelle et stimuler la croissance des ventes.


## 2.5 Dimension g√©ographique
Dans la dimension r√©gionale, nous r√©pondrons principalement aux questions suivantes : De quelles villes aux √âtats-Unis proviennent principalement les clients ? Quelle ville a le pouvoir d‚Äôachat moyen des clients le plus √©lev√©¬†?

### 2.5.1 R√©partition des clients dans les villes am√©ricaines
```{r}
# Filtrer les clients des √âtats-Unis
us_customers <- data_usa %>% filter(Country == "United States")

# Calculer le nombre de clients par ville
city_customers <- us_customers %>%
  group_by(City) %>%
  summarise(CustomerCount = n()) %>%
  arrange(desc(CustomerCount))

# S√©lectionner les 10 premi√®res villes par nombre de clients
top_city_customers <- city_customers %>% top_n(10, CustomerCount)

# Tracer le nombre de clients dans les 10 premi√®res villes
ggplot(top_city_customers, aes(x = reorder(City, CustomerCount), y = CustomerCount)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  coord_flip() +
  labs(
    title = "Top 10 des villes par nombre de clients aux √âtats-Unis",
    x = "Ville",
    y = "Nombre de clients (personnes)"
  ) +
  theme_minimal()
```

Nous pouvons voir que New York et Los Angeles sont les deux villes avec les ventes et le volume de clients les plus √©lev√©s. Dans le m√™me temps, les ventes et le volume de clients de Philadelphie, San Francisco, Seattle, Houston et Chicago sont bien sup√©rieurs √† ceux des autres villes. villes. Nous devrions nous concentrer sur ces villes et √©laborer un plan de vente.

### 2.5.2 Pouvoir d‚Äôachat moyen des clients dans diff√©rentes villes
Nous calculons les ventes moyennes des clients dans chaque ville pour d√©terminer quelle ville a le pouvoir d'achat moyen le plus √©lev√©. Comme il y a trop de villes, notre image s√©lectionne uniquement les 10 premi√®res villes √† afficher.

```{r}
# Filtrer les clients des √âtats-Unis
us_customers <- data_usa %>% filter(Country == "United States")

# Calculer les ventes moyennes par ville
city_avg_sales <- us_customers %>%
  group_by(City) %>%
  summarise(AverageSales = mean(Sales, na.rm = TRUE)) %>%
  arrange(desc(AverageSales))

# S√©lectionner les 10 villes avec les ventes moyennes les plus √©lev√©es
top_city_avg_sales <- city_avg_sales %>% top_n(10, AverageSales)

# Tracer le graphique
ggplot(top_city_avg_sales, aes(x = reorder(City, AverageSales), y = AverageSales)) +
  geom_bar(stat = "identity", fill = "salmon") +
  coord_flip() +
  labs(title = "Top 10 des villes par ventes moyennes aux √âtats-Unis", x = "Ville", y = "Ventes moyennes (USD)") +
  scale_y_continuous(labels = scales::dollar_format(prefix = "$")) +
  theme_minimal()

```

Ce graphique montre les 10 villes des √âtats-Unis avec les ventes moyennes les plus √©lev√©es. Chaque barre repr√©sente les ventes moyennes pour une ville donn√©e. Les noms des villes sont affich√©s sur l'axe vertical, tandis que les ventes moyennes sont affich√©es sur l'axe horizontal en dollars am√©ricains.

D'apr√®s le graphique :

Jamestown est la ville avec les ventes moyennes les plus √©lev√©es, bien au-dessus des autres villes.
Cheyenne et Bellingham suivent respectivement en deuxi√®me et troisi√®me positions.
D'autres villes comme Independence, Burbank, etc., sont √©galement parmi les 10 premi√®res.
Ce graphique aide √† comprendre quelles villes ont les clients qui d√©pensent le plus en moyenne par transaction, ce qui est pr√©cieux pour l'√©laboration de strat√©gies de marketing et de vente.

# 3 Conclusion 
Dans ce projet d'analyse de donn√©es, nous avons utilis√© le langage R pour effectuer une analyse approfondie des donn√©es de ventes des supermarch√©s. Nous avons analys√© les supermarch√©s aux √âtats-Unis et au Myanmar sous cinq dimensions, et avons finalement produit une application Shiny pour mettre en ≈ìuvre des graphiques interactifs sur le nombre de clients et le montant moyen des ventes dans diff√©rentes villes.

## 3.1 Difficult√©s et d√©fis

Au cours du projet, nous avons rencontr√© les difficult√©s et d√©fis suivants :

- **Nettoyage et pr√©traitement des donn√©es**¬†: en raison du format de date non uniforme dans l'ensemble de donn√©es, nous avons pass√© beaucoup de temps √† nettoyer et √† convertir le format de date afin d'effectuer une analyse de la dimension temporelle.
- **Impl√©mentation de graphiques interactifs** : Lorsque vous utilisez le framework Shiny pour impl√©menter des graphiques interactifs, vous devez traiter une grande quantit√© de donn√©es et garantir une vitesse de r√©ponse, ce qui augmente la complexit√© dans une certaine mesure.
- **Grand volume de donn√©es**¬†: Le traitement et l'analyse de grandes quantit√©s de donn√©es mettent √† rude √©preuve nos ressources informatiques, en particulier lors de l'ex√©cution d'analyses interactives en temps r√©el.

# 4 Annexe
Cette page enregistre la r√©partition du travail de chaque membre de l'√©quipe. La description de poste de chaque membre est d√©taill√©e ci-dessous.

## 4.1 R√©partition du travail des membres

### 4.1.1 Yifei

Yifei √©tait charg√© de r√©soudre les probl√®mes li√©s aux dimensions temporelles et g√©ographiques, et a utilis√© Shiny pour cr√©er des graphiques interactifs sur le nombre de clients et le montant moyen des ventes dans diff√©rentes villes. Les travaux sp√©cifiques comprennent, sans toutefois s'y limiter¬†:

- Traitement des donn√©es dans la dimension temporelle, y compris la conversion du format de date et l'analyse des s√©ries chronologiques.
- Analyse li√©e √† la dimension g√©ographique et √† la dimension temporelle
- √Ä l'aide du framework Shiny, d√©veloppement de graphiques interactifs montrant le nombre de clients et le montant moyen des ventes dans diff√©rentes villes. La fonction d'ajustement du nombre de villes affich√©es et de s√©lection des diff√©rentes ann√©es via la barre de progression est mise en ≈ìuvre pour assurer l'interactivit√© dynamique du graphique.

